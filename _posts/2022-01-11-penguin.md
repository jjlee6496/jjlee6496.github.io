---
title: "데이콘 펭귄 몸무게 예측 경연대회"
categories: ['ML']
output: 
  prettydoc::html_pretty:
    theme: leonids
    highlight: github
---
<style type="text/css">
  @font-face {
      font-family: 'twayair';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_tway@1.0/twayair.woff') 
      format('woff');
      font-weight: normal;
      font-style: normal;
  }
  body{
    font-family: 'twayair';
  }
</style>


# 데이터 불러오기


```python
from google.colab import drive
drive.mount('/content/drive')
```

    Mounted at /content/drive
    


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
pd.set_option('display.max_columns', 100) 

import warnings
warnings.filterwarnings("ignore")
```

1. train.csv : 학습 데이터
* id : 샘플 아이디
* Species: 펭귄의 종을 나타내는 문자열
* Island : 샘플들이 수집된 Palmer Station 근처 섬 이름
* Clutch Completion : 관찰된 펭귄 둥지의 알이 2개인 경우 Full Clutch이며 Yes로 표기
* Culmen Length (mm) : 펭귄 옆모습 기준 부리의 가로 길이
* Culmen Depth (mm) : 펭귄 옆모습 기준 부리의 세로 길이
* Flipper Length (mm) : 펭귄의 팔(날개) 길이
* Sex : 펭귄의 성별
* Delta 15 N (o/oo)  : 토양에 따라 변화하는 안정 동위원소 15N:14N의 비율
* Delta 13 C (o/oo) : 먹이에 따라 변화하는 안정 동위원소 13C:12C의 비율
* Body Mass (g): 펭귄의 몸무게를 나타내는 숫자 (g)


2. test.csv : 테스트 데이터
* id : 샘플 아이디
* Species: 펭귄의 종을 나타내는 문자열
* Island : 샘플들이 수집된 Palmer Station 근처 섬 이름
* Clutch Completion : 관찰된 펭귄 둥지의 알이 2개인 경우 Full Clutch이며 Yes로 표기
* Culmen Length (mm) : 펭귄 옆모습 기준 부리의 가로 길이
* Culmen Depth (mm) : 펭귄 옆모습 기준 부리의 세로 길이
* Flipper Length (mm) : 펭귄의 팔(날개) 길이
* Sex : 펭귄의 성별
* Delta 15 N (o/oo)  : 토양에 따라 변화하는 안정 동위원소 15N:14N의 비율
* Delta 13 C (o/oo) : 먹이에 따라 변화하는 안정 동위원소 13C:12C의 비율


3. sample_submissoin.csv : 제출 양식
id : 샘플 아이디
Body Mass (g) : 펭귄의 몸무게를 나타내는 숫자 (g)




데이터 상세 설명
성인 Adélie, Chinstrap 및 Gentoo 펭귄의 둥지 관찰, 펭귄 크기 데이터 및 혈액 샘플의 동위원소 측정을 포함한 데이터입니다.
남극의 Palmer Station 근처 Palmer 군도에 있는 섬에서 관찰된 Adélie, chinstrap, Gentoo 펭귄의 먹이를 찾는 성체의 크기 측정, 클러치 관찰 및 혈액 동위원소 비율. 
데이터는 Kristen Gor man 박사와 Palmer Station Long Term Ecological Research(LTER) 프로그램에 의해 수집되어 제공되었습니다.
출처: https://allisonhorst.github.io/palmerpenguins/


```python
train = pd.read_csv("/content/drive/MyDrive/daycon/penguin/train.csv")
test = pd.read_csv("/content/drive/MyDrive/daycon/penguin/test.csv")
```

# EDA

결측치


```python
# id 는 제외하고 분석합니다.
train = train.drop('id', axis=1)
```


```python
train.head()
```





  <div id="df-dccbdd1d-7797-456d-ac7c-cbc5c360c643">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Clutch Completion</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Body Mass (g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>50.0</td>
      <td>15.3</td>
      <td>220</td>
      <td>MALE</td>
      <td>8.30515</td>
      <td>-25.19017</td>
      <td>5550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>No</td>
      <td>49.5</td>
      <td>19.0</td>
      <td>200</td>
      <td>MALE</td>
      <td>9.63074</td>
      <td>-24.34684</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>45.1</td>
      <td>14.4</td>
      <td>210</td>
      <td>FEMALE</td>
      <td>8.51951</td>
      <td>-27.01854</td>
      <td>4400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>44.5</td>
      <td>14.7</td>
      <td>214</td>
      <td>FEMALE</td>
      <td>8.20106</td>
      <td>-26.16524</td>
      <td>4850</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>No</td>
      <td>49.6</td>
      <td>16.0</td>
      <td>225</td>
      <td>MALE</td>
      <td>8.38324</td>
      <td>-26.84272</td>
      <td>5700</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-dccbdd1d-7797-456d-ac7c-cbc5c360c643')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-dccbdd1d-7797-456d-ac7c-cbc5c360c643 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-dccbdd1d-7797-456d-ac7c-cbc5c360c643');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
train[train.isna().sum(axis=1) > 0]
```





  <div id="df-a398fbe2-1804-4c48-b112-f97b621de5cb">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Clutch Completion</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Body Mass (g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Torgersen</td>
      <td>Yes</td>
      <td>42.0</td>
      <td>20.2</td>
      <td>190</td>
      <td>NaN</td>
      <td>9.13362</td>
      <td>-25.09368</td>
      <td>4250</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Torgersen</td>
      <td>Yes</td>
      <td>34.1</td>
      <td>18.1</td>
      <td>193</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3475</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Dream</td>
      <td>No</td>
      <td>39.8</td>
      <td>19.1</td>
      <td>184</td>
      <td>MALE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4650</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>46.2</td>
      <td>14.4</td>
      <td>214</td>
      <td>NaN</td>
      <td>8.24253</td>
      <td>-26.81540</td>
      <td>4650</td>
    </tr>
    <tr>
      <th>109</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Torgersen</td>
      <td>Yes</td>
      <td>36.6</td>
      <td>17.8</td>
      <td>185</td>
      <td>FEMALE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3700</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a398fbe2-1804-4c48-b112-f97b621de5cb')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a398fbe2-1804-4c48-b112-f97b621de5cb button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a398fbe2-1804-4c48-b112-f97b621de5cb');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
train.isnull().sum()
```




    Species                0
    Island                 0
    Clutch Completion      0
    Culmen Length (mm)     0
    Culmen Depth (mm)      0
    Flipper Length (mm)    0
    Sex                    3
    Delta 15 N (o/oo)      3
    Delta 13 C (o/oo)      3
    Body Mass (g)          0
    dtype: int64




```python
def check_missing_col(dataframe):
    missing_col = []
    counted_missing_col = 0
    for i, col in enumerate(dataframe.columns):
        missing_values = sum(dataframe[col].isna())
        is_missing = True if missing_values >= 1 else False
        if is_missing:
            counted_missing_col += 1
            print(f'결측치가 있는 컬럼은: {col}입니다')
            print(f'해당 컬럼에 총 {missing_values}개의 결측치가 존재합니다.')
            missing_col.append([col, dataframe[col].dtype])
    if counted_missing_col == 0:
        print('결측치가 존재하지 않습니다')
    return missing_col

missing_col = check_missing_col(train)
```

    결측치가 있는 컬럼은: Sex입니다
    해당 컬럼에 총 3개의 결측치가 존재합니다.
    결측치가 있는 컬럼은: Delta 15 N (o/oo)입니다
    해당 컬럼에 총 3개의 결측치가 존재합니다.
    결측치가 있는 컬럼은: Delta 13 C (o/oo)입니다
    해당 컬럼에 총 3개의 결측치가 존재합니다.
    

딱히 패턴은 없어보임, 범주형은 행 삭제, 수치형은 평균값으로 대치


```python
def handle_na(data, missing_col):
    temp = data.copy()
    for col, dtype in missing_col:
        if dtype == 'O':
            # 카테고리형 feature가 결측치인 경우 해당 행들을 삭제해 주었습니다.
            temp = temp.dropna(subset=[col])
        elif dtype == int or dtype == float:
            # 수치형 feature가 결측치인 경우 평균값을 채워주었습니다.
            temp.loc[:,col] = temp[col].fillna(temp[col].mean())
    return temp

data = handle_na(train, missing_col)

# 결측치 처리가 잘 되었는지 확인해 줍니다.
missing_col = check_missing_col(data) 
```

    결측치가 존재하지 않습니다
    


```python
numeric_feature = data.columns[(data.dtypes==int) | (data.dtypes== float)]
categorical_feature = data.columns[data.dtypes=='O']

print("수치형 데이터는 다음과 같습니다. \n", list(numeric_feature))
print("카테고리형 데이터는 다음과 같습니다. \n", list(categorical_feature))
```

    수치형 데이터는 다음과 같습니다. 
     ['Culmen Length (mm)', 'Culmen Depth (mm)', 'Flipper Length (mm)', 'Delta 15 N (o/oo)', 'Delta 13 C (o/oo)', 'Body Mass (g)']
    카테고리형 데이터는 다음과 같습니다. 
     ['Species', 'Island', 'Clutch Completion', 'Sex']
    

수치형 데이터 시각화


```python
plt.style.use("ggplot")

feature = numeric_feature

# Boxplot 을 사용해서 데이터의 분포를 살펴봅니다.
plt.figure(figsize=(20,15))
plt.suptitle("Boxplots", fontsize=40)

for i in range(len(feature)):
    plt.subplot(2,3,i+1)
    plt.title(feature[i])
    plt.boxplot(data[feature[i]])
plt.show()
```


    
![png](output_16_0.png)
    


범주형 데이터 시각화


```python
# 히스토그램 을 사용해서 데이터의 분포를 살펴봅니다.
feature = categorical_feature

plt.figure(figsize=(20,15))
plt.suptitle("Bar Plot", fontsize=40)

for i in range(len(feature)):
    plt.subplot(2,2,i+1)
    plt.title(feature[i], fontsize=20)
    temp = data[feature[i]].value_counts()
    plt.bar(temp.keys(), temp.values, width=0.5, color='b', alpha=0.5)
    plt.xticks(temp.keys(), fontsize=12)
plt.tight_layout(rect=[0, 0.03, 1, 0.95])
plt.show()
```


    
![png](output_18_0.png)
    


상관관계 시각화


```python
# 먼저 상관계수 계산을 위해 텍스트 형식의 데이터를 숫자로 변환해줍니다.
from sklearn.preprocessing import LabelEncoder

corr_df = data.copy()
corr_df[corr_df.columns[corr_df.dtypes=='O']] = corr_df[corr_df.columns[corr_df.dtypes=='O']].astype(str).apply(LabelEncoder().fit_transform)
```


```python
#상관관계 분석도
plt.figure(figsize=(15,10))

heat_table = corr_df.corr()
mask = np.zeros_like(heat_table)
mask[np.triu_indices_from(mask)] = True
heatmap_ax = sns.heatmap(heat_table, annot=True, mask = mask, cmap='coolwarm')
heatmap_ax.set_xticklabels(heatmap_ax.get_xticklabels(), fontsize=15, rotation=45)
heatmap_ax.set_yticklabels(heatmap_ax.get_yticklabels(), fontsize=15)
plt.title('correlation between features', fontsize=40)
plt.show()
```


    
![png](output_21_0.png)
    


Target과 다른 feature들과의 관계


```python
target = "Body Mass (g)"

feature = numeric_feature

plt.figure(figsize=(20,15))
plt.suptitle("Scatter Plot", fontsize=40)

# id는 제외하고 시각화합니다.
for i in range(len(feature[:-1])):
    plt.subplot(2,3,i+1)
    plt.xlabel(feature[i])
    plt.ylabel(target)
    corr_score = data[[feature[i], target]].corr().iloc[0,1].round(2)
    c = 'red' if corr_score > 0 else 'blue'
    plt.scatter(data[feature[i]], data[target], color=c, label=f"corr = {corr_score}")
    plt.legend(fontsize=15)
plt.tight_layout(rect=[0, 0.03, 1, 0.95])
plt.show()
```


    
![png](output_23_0.png)
    


# 모델

파이캐럿으로 보기


```python
!pip install pycaret
```


```python
import pandas as pd
import numpy as np
from pycaret.classification import *
```


```python
train = pd.read_csv("/content/drive/MyDrive/daycon/penguin/train.csv")
test = pd.read_csv("/content/drive/MyDrive/daycon/penguin/test.csv")

train = train.drop('id', 1)
train.head()
```





  <div id="df-d2d14b82-c99e-4578-8c3d-02b0b1c0bdd2">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Clutch Completion</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Body Mass (g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>50.0</td>
      <td>15.3</td>
      <td>220</td>
      <td>MALE</td>
      <td>8.30515</td>
      <td>-25.19017</td>
      <td>5550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>No</td>
      <td>49.5</td>
      <td>19.0</td>
      <td>200</td>
      <td>MALE</td>
      <td>9.63074</td>
      <td>-24.34684</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>45.1</td>
      <td>14.4</td>
      <td>210</td>
      <td>FEMALE</td>
      <td>8.51951</td>
      <td>-27.01854</td>
      <td>4400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>44.5</td>
      <td>14.7</td>
      <td>214</td>
      <td>FEMALE</td>
      <td>8.20106</td>
      <td>-26.16524</td>
      <td>4850</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>No</td>
      <td>49.6</td>
      <td>16.0</td>
      <td>225</td>
      <td>MALE</td>
      <td>8.38324</td>
      <td>-26.84272</td>
      <td>5700</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d2d14b82-c99e-4578-8c3d-02b0b1c0bdd2')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d2d14b82-c99e-4578-8c3d-02b0b1c0bdd2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d2d14b82-c99e-4578-8c3d-02b0b1c0bdd2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
setup(train, target = 'Body Mass (g)', session_id = 1234) 
```

상위5개 모델 선택


```python
top5 = compare_models(sort='RMSE', n_select=5)
```



  <div id="df-0a118a40-72ed-4409-8fc6-98f958ec230c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
      <th>TT (Sec)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>llar</th>
      <td>Lasso Least Angle Regression</td>
      <td>237.1825</td>
      <td>95773.2963</td>
      <td>302.8269</td>
      <td>0.8068</td>
      <td>0.0722</td>
      <td>0.0563</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>lasso</th>
      <td>Lasso Regression</td>
      <td>241.6721</td>
      <td>98305.6848</td>
      <td>306.7771</td>
      <td>0.7977</td>
      <td>0.0733</td>
      <td>0.0575</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>lr</th>
      <td>Linear Regression</td>
      <td>243.4536</td>
      <td>99257.0195</td>
      <td>308.1713</td>
      <td>0.7949</td>
      <td>0.0737</td>
      <td>0.0580</td>
      <td>0.011</td>
    </tr>
    <tr>
      <th>ridge</th>
      <td>Ridge Regression</td>
      <td>238.2704</td>
      <td>99319.7211</td>
      <td>309.1398</td>
      <td>0.7990</td>
      <td>0.0741</td>
      <td>0.0568</td>
      <td>0.011</td>
    </tr>
    <tr>
      <th>br</th>
      <td>Bayesian Ridge</td>
      <td>240.6217</td>
      <td>101419.6847</td>
      <td>312.9012</td>
      <td>0.7950</td>
      <td>0.0752</td>
      <td>0.0574</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>huber</th>
      <td>Huber Regressor</td>
      <td>262.5410</td>
      <td>116865.0087</td>
      <td>337.2554</td>
      <td>0.7690</td>
      <td>0.0827</td>
      <td>0.0634</td>
      <td>0.035</td>
    </tr>
    <tr>
      <th>et</th>
      <td>Extra Trees Regressor</td>
      <td>269.8152</td>
      <td>120356.8096</td>
      <td>339.6383</td>
      <td>0.7562</td>
      <td>0.0806</td>
      <td>0.0639</td>
      <td>0.351</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Regressor</td>
      <td>270.2018</td>
      <td>128069.6109</td>
      <td>346.4551</td>
      <td>0.7334</td>
      <td>0.0806</td>
      <td>0.0634</td>
      <td>0.402</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>AdaBoost Regressor</td>
      <td>273.2570</td>
      <td>127545.8685</td>
      <td>347.9039</td>
      <td>0.7456</td>
      <td>0.0810</td>
      <td>0.0639</td>
      <td>0.067</td>
    </tr>
    <tr>
      <th>lightgbm</th>
      <td>Light Gradient Boosting Machine</td>
      <td>274.6065</td>
      <td>133761.7072</td>
      <td>354.4574</td>
      <td>0.7076</td>
      <td>0.0832</td>
      <td>0.0651</td>
      <td>0.020</td>
    </tr>
    <tr>
      <th>gbr</th>
      <td>Gradient Boosting Regressor</td>
      <td>280.1973</td>
      <td>140806.4042</td>
      <td>360.0743</td>
      <td>0.7148</td>
      <td>0.0825</td>
      <td>0.0646</td>
      <td>0.042</td>
    </tr>
    <tr>
      <th>en</th>
      <td>Elastic Net</td>
      <td>286.8319</td>
      <td>147805.9740</td>
      <td>374.2155</td>
      <td>0.7062</td>
      <td>0.0908</td>
      <td>0.0695</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>omp</th>
      <td>Orthogonal Matching Pursuit</td>
      <td>319.8686</td>
      <td>171270.8656</td>
      <td>403.5570</td>
      <td>0.6506</td>
      <td>0.0985</td>
      <td>0.0778</td>
      <td>0.011</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>K Neighbors Regressor</td>
      <td>312.5804</td>
      <td>171918.6161</td>
      <td>409.7862</td>
      <td>0.6533</td>
      <td>0.0981</td>
      <td>0.0750</td>
      <td>0.061</td>
    </tr>
    <tr>
      <th>dt</th>
      <td>Decision Tree Regressor</td>
      <td>322.5446</td>
      <td>197536.8304</td>
      <td>422.9484</td>
      <td>0.6293</td>
      <td>0.0984</td>
      <td>0.0744</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>lar</th>
      <td>Least Angle Regression</td>
      <td>455.6183</td>
      <td>743984.8498</td>
      <td>571.5322</td>
      <td>-0.7240</td>
      <td>0.1624</td>
      <td>0.1073</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>par</th>
      <td>Passive Aggressive Regressor</td>
      <td>682.3199</td>
      <td>668121.8978</td>
      <td>764.2784</td>
      <td>-0.4642</td>
      <td>0.1794</td>
      <td>0.1637</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>dummy</th>
      <td>Dummy Regressor</td>
      <td>696.2472</td>
      <td>651348.5215</td>
      <td>788.4169</td>
      <td>-0.1850</td>
      <td>0.1830</td>
      <td>0.1652</td>
      <td>0.009</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0a118a40-72ed-4409-8fc6-98f958ec230c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0a118a40-72ed-4409-8fc6-98f958ec230c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0a118a40-72ed-4409-8fc6-98f958ec230c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>



모델 튜닝


```python
tuned_top5 = [tune_model(i) for i in top5]
```



  <div id="df-bcbb32c5-2a95-46ab-8ef0-dc60ca7ba419">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>239.8925</td>
      <td>92830.1599</td>
      <td>304.6804</td>
      <td>0.8694</td>
      <td>0.0765</td>
      <td>0.0584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>267.4700</td>
      <td>140047.7323</td>
      <td>374.2295</td>
      <td>0.8361</td>
      <td>0.1116</td>
      <td>0.0765</td>
    </tr>
    <tr>
      <th>2</th>
      <td>228.4978</td>
      <td>116777.1039</td>
      <td>341.7267</td>
      <td>0.7287</td>
      <td>0.0779</td>
      <td>0.0500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>239.5832</td>
      <td>84462.5564</td>
      <td>290.6244</td>
      <td>0.7427</td>
      <td>0.0706</td>
      <td>0.0591</td>
    </tr>
    <tr>
      <th>4</th>
      <td>323.6370</td>
      <td>159256.4134</td>
      <td>399.0694</td>
      <td>0.6346</td>
      <td>0.1014</td>
      <td>0.0864</td>
    </tr>
    <tr>
      <th>5</th>
      <td>206.5459</td>
      <td>69727.9805</td>
      <td>264.0606</td>
      <td>0.8179</td>
      <td>0.0682</td>
      <td>0.0515</td>
    </tr>
    <tr>
      <th>6</th>
      <td>271.1594</td>
      <td>148104.3289</td>
      <td>384.8433</td>
      <td>0.8484</td>
      <td>0.0724</td>
      <td>0.0529</td>
    </tr>
    <tr>
      <th>7</th>
      <td>177.6359</td>
      <td>51995.8290</td>
      <td>228.0259</td>
      <td>0.9105</td>
      <td>0.0508</td>
      <td>0.0373</td>
    </tr>
    <tr>
      <th>8</th>
      <td>181.4046</td>
      <td>50534.8478</td>
      <td>224.7996</td>
      <td>0.8806</td>
      <td>0.0484</td>
      <td>0.0386</td>
    </tr>
    <tr>
      <th>9</th>
      <td>270.3963</td>
      <td>100466.8313</td>
      <td>316.9650</td>
      <td>0.6807</td>
      <td>0.0739</td>
      <td>0.0635</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>240.6222</td>
      <td>101420.3783</td>
      <td>312.9025</td>
      <td>0.7950</td>
      <td>0.0752</td>
      <td>0.0574</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>42.6791</td>
      <td>36947.3949</td>
      <td>59.2656</td>
      <td>0.0879</td>
      <td>0.0185</td>
      <td>0.0145</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bcbb32c5-2a95-46ab-8ef0-dc60ca7ba419')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bcbb32c5-2a95-46ab-8ef0-dc60ca7ba419 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bcbb32c5-2a95-46ab-8ef0-dc60ca7ba419');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>



모델 Blending


```python
blender_top5 = blend_models(estimator_list=tuned_top5)
```



  <div id="df-99741a89-4ad5-47f8-b53d-5eeae307f3b1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>234.6786</td>
      <td>86931.5678</td>
      <td>294.8416</td>
      <td>0.8777</td>
      <td>0.0720</td>
      <td>0.0561</td>
    </tr>
    <tr>
      <th>1</th>
      <td>263.4556</td>
      <td>136908.3106</td>
      <td>370.0112</td>
      <td>0.8397</td>
      <td>0.1105</td>
      <td>0.0756</td>
    </tr>
    <tr>
      <th>2</th>
      <td>227.3379</td>
      <td>109264.8820</td>
      <td>330.5524</td>
      <td>0.7461</td>
      <td>0.0750</td>
      <td>0.0499</td>
    </tr>
    <tr>
      <th>3</th>
      <td>231.2234</td>
      <td>79587.3186</td>
      <td>282.1122</td>
      <td>0.7576</td>
      <td>0.0687</td>
      <td>0.0571</td>
    </tr>
    <tr>
      <th>4</th>
      <td>320.5673</td>
      <td>151730.3066</td>
      <td>389.5257</td>
      <td>0.6519</td>
      <td>0.0994</td>
      <td>0.0857</td>
    </tr>
    <tr>
      <th>5</th>
      <td>200.7110</td>
      <td>61869.9370</td>
      <td>248.7367</td>
      <td>0.8384</td>
      <td>0.0640</td>
      <td>0.0497</td>
    </tr>
    <tr>
      <th>6</th>
      <td>279.5947</td>
      <td>152487.9262</td>
      <td>390.4970</td>
      <td>0.8439</td>
      <td>0.0731</td>
      <td>0.0543</td>
    </tr>
    <tr>
      <th>7</th>
      <td>179.8003</td>
      <td>53055.8634</td>
      <td>230.3386</td>
      <td>0.9087</td>
      <td>0.0508</td>
      <td>0.0374</td>
    </tr>
    <tr>
      <th>8</th>
      <td>147.6333</td>
      <td>39650.9476</td>
      <td>199.1255</td>
      <td>0.9064</td>
      <td>0.0424</td>
      <td>0.0310</td>
    </tr>
    <tr>
      <th>9</th>
      <td>260.2052</td>
      <td>99438.3027</td>
      <td>315.3384</td>
      <td>0.6839</td>
      <td>0.0733</td>
      <td>0.0606</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>234.5207</td>
      <td>97092.5362</td>
      <td>305.1079</td>
      <td>0.8054</td>
      <td>0.0729</td>
      <td>0.0557</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>47.6256</td>
      <td>38317.0638</td>
      <td>63.2589</td>
      <td>0.0860</td>
      <td>0.0191</td>
      <td>0.0153</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-99741a89-4ad5-47f8-b53d-5eeae307f3b1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-99741a89-4ad5-47f8-b53d-5eeae307f3b1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-99741a89-4ad5-47f8-b53d-5eeae307f3b1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>



예측


```python
final_model = finalize_model(blender_top5)
prediction = predict_model(final_model, data=train)
```


```python
from pycaret.utils import check_metric
check_metric(prediction['Body Mass (g)'], prediction['Label'], metric = 'RMSE')
```


    ---------------------------------------------------------------------------

    NameError                                 Traceback (most recent call last)

    <ipython-input-17-71d16854ba23> in <module>()
          1 from pycaret.utils import check_metric
    ----> 2 check_metric(prediction['Body Mass (g)'], prediction['Label'], metric = 'RMSE')
    

    NameError: name 'prediction' is not defined


제출


```python
submission = pd.read_csv('/content/drive/MyDrive/daycon/penguin/sample_submission.csv', index_col = 0)
submission.head()
```





  <div id="df-a7651fcb-da8d-4c89-84aa-7c27ea8945c9">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Body Mass (g)</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a7651fcb-da8d-4c89-84aa-7c27ea8945c9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a7651fcb-da8d-4c89-84aa-7c27ea8945c9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a7651fcb-da8d-4c89-84aa-7c27ea8945c9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
test = test.drop('id', 1)
test.head()
```





  <div id="df-b365febc-c568-402d-929b-e5bc5abef0f3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Clutch Completion</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>Yes</td>
      <td>52.0</td>
      <td>20.7</td>
      <td>210.0</td>
      <td>MALE</td>
      <td>9.43146</td>
      <td>-24.68440</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>55.9</td>
      <td>17.0</td>
      <td>228.0</td>
      <td>MALE</td>
      <td>8.31180</td>
      <td>-26.35425</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Dream</td>
      <td>Yes</td>
      <td>38.9</td>
      <td>18.8</td>
      <td>190.0</td>
      <td>FEMALE</td>
      <td>8.36936</td>
      <td>-26.11199</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>Yes</td>
      <td>45.2</td>
      <td>16.6</td>
      <td>191.0</td>
      <td>FEMALE</td>
      <td>9.62357</td>
      <td>-24.78984</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Biscoe</td>
      <td>No</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>FEMALE</td>
      <td>8.38404</td>
      <td>-25.19837</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b365febc-c568-402d-929b-e5bc5abef0f3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b365febc-c568-402d-929b-e5bc5abef0f3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b365febc-c568-402d-929b-e5bc5abef0f3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
pred = predict_model(final_model, data = test)
pred.head()
```





  <div id="df-fa8c549d-5f56-4f9e-9bc7-3dc9347c7dd4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Clutch Completion</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>Yes</td>
      <td>52.0</td>
      <td>20.7</td>
      <td>210.0</td>
      <td>MALE</td>
      <td>9.43146</td>
      <td>-24.68440</td>
      <td>4368.541849</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>Yes</td>
      <td>55.9</td>
      <td>17.0</td>
      <td>228.0</td>
      <td>MALE</td>
      <td>8.31180</td>
      <td>-26.35425</td>
      <td>5633.380385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Dream</td>
      <td>Yes</td>
      <td>38.9</td>
      <td>18.8</td>
      <td>190.0</td>
      <td>FEMALE</td>
      <td>8.36936</td>
      <td>-26.11199</td>
      <td>3633.075801</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>Yes</td>
      <td>45.2</td>
      <td>16.6</td>
      <td>191.0</td>
      <td>FEMALE</td>
      <td>9.62357</td>
      <td>-24.78984</td>
      <td>3374.191632</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie Penguin (Pygoscelis adeliae)</td>
      <td>Biscoe</td>
      <td>No</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>FEMALE</td>
      <td>8.38404</td>
      <td>-25.19837</td>
      <td>3444.562327</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fa8c549d-5f56-4f9e-9bc7-3dc9347c7dd4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fa8c549d-5f56-4f9e-9bc7-3dc9347c7dd4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fa8c549d-5f56-4f9e-9bc7-3dc9347c7dd4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
submission['Body Mass (g)'] = pred['Label']
submission.head()
```





  <div id="df-32948838-fed8-41c3-bc57-1e143ea16685">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Body Mass (g)</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4368.541849</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5633.380385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3633.075801</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3374.191632</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3444.562327</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-32948838-fed8-41c3-bc57-1e143ea16685')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-32948838-fed8-41c3-bc57-1e143ea16685 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-32948838-fed8-41c3-bc57-1e143ea16685');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
submission.to_csv('pycaret.csv')
```

점수: 287.78

# 추가분석, 새로운 지표 생성 및 분석


```python
!pip install pycaret
```


```python
import numpy as np
import pandas as pd
from pycaret.regression import *
```


```python
train = pd.read_csv("/content/drive/MyDrive/daycon/penguin/train.csv")
test = pd.read_csv("/content/drive/MyDrive/daycon/penguin/test.csv")

train = train.drop('id', 1)
Mass = train['Body Mass (g)']
train = train.drop('Body Mass (g)', 1)
train = train.drop('Clutch Completion', 1)
test = test.drop('Clutch Completion', 1)
```


```python
train.head()
```





  <div id="df-81dea739-5923-465a-98c5-2dd375932181">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>50.0</td>
      <td>15.3</td>
      <td>220</td>
      <td>MALE</td>
      <td>8.30515</td>
      <td>-25.19017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>49.5</td>
      <td>19.0</td>
      <td>200</td>
      <td>MALE</td>
      <td>9.63074</td>
      <td>-24.34684</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>45.1</td>
      <td>14.4</td>
      <td>210</td>
      <td>FEMALE</td>
      <td>8.51951</td>
      <td>-27.01854</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>44.5</td>
      <td>14.7</td>
      <td>214</td>
      <td>FEMALE</td>
      <td>8.20106</td>
      <td>-26.16524</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>49.6</td>
      <td>16.0</td>
      <td>225</td>
      <td>MALE</td>
      <td>8.38324</td>
      <td>-26.84272</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-81dea739-5923-465a-98c5-2dd375932181')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-81dea739-5923-465a-98c5-2dd375932181 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-81dea739-5923-465a-98c5-2dd375932181');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




전처리 ver1: 성별제외 결측치도 모델만들어서


```python
train['Sex']=np.where(train['Sex'].values=='MALE',1,np.where(train['Sex'].values=='FEMALE',0,np.nan))
test['Sex']=np.where(test['Sex'].values=='MALE',1,np.where(test['Sex'].values=='FEMALE',0,np.nan))
#train['Clutch Completion']=np.where(train['Clutch Completion'].values=='Yes',1,0)
#test['Clutch Completion']=np.where(test['Clutch Completion'].values=='Yes',1,0)
train = pd.concat([train,pd.get_dummies(train[['Island','Species']])],axis=1)
test = pd.concat([test,pd.get_dummies(test[['Island','Species']])],axis=1)
train = train.drop(['Island','Species'],axis=1)
test = test.drop(['Island','Species'],axis=1)
```


```python
train.isnull().sum(),test.isnull().sum()
```

전처리 ver2: 성별 제외 결측치를 그냥 평균대치


```python
train.fillna({'Delta 13 C (o/oo)':train['Delta 13 C (o/oo)'].mean()}, inplace=True)
test.fillna({'Delta 13 C (o/oo)':test['Delta 13 C (o/oo)'].mean()}, inplace=True)
```


```python
train['Culmen Width'] = train['Culmen Length (mm)']*train['Culmen Depth (mm)']
test['Culmen Width'] = test['Culmen Length (mm)']*test['Culmen Depth (mm)']
```


```python
train['Sex']=np.where(train['Sex'].values=='MALE',1,np.where(train['Sex'].values=='FEMALE',0,np.nan))
test['Sex']=np.where(test['Sex'].values=='MALE',1,np.where(test['Sex'].values=='FEMALE',0,np.nan))
#train['Clutch Completion']=np.where(train['Clutch Completion'].values=='Yes',1,0)
#test['Clutch Completion']=np.where(test['Clutch Completion'].values=='Yes',1,0)
train = pd.concat([train,pd.get_dummies(train[['Island','Species']])],axis=1)
test = pd.concat([test,pd.get_dummies(test[['Island','Species']])],axis=1)
train = train.drop(['Island','Species'],axis=1)
test = test.drop(['Island','Species'],axis=1)
```


```python
train.head()
```





  <div id="df-0bd48f85-1666-4d7b-bf45-01fc4727c64d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Island</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Culmen Width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>50.0</td>
      <td>15.3</td>
      <td>220</td>
      <td>MALE</td>
      <td>8.30515</td>
      <td>-25.19017</td>
      <td>765.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chinstrap penguin (Pygoscelis antarctica)</td>
      <td>Dream</td>
      <td>49.5</td>
      <td>19.0</td>
      <td>200</td>
      <td>MALE</td>
      <td>9.63074</td>
      <td>-24.34684</td>
      <td>940.50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>45.1</td>
      <td>14.4</td>
      <td>210</td>
      <td>FEMALE</td>
      <td>8.51951</td>
      <td>-27.01854</td>
      <td>649.44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>44.5</td>
      <td>14.7</td>
      <td>214</td>
      <td>FEMALE</td>
      <td>8.20106</td>
      <td>-26.16524</td>
      <td>654.15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gentoo penguin (Pygoscelis papua)</td>
      <td>Biscoe</td>
      <td>49.6</td>
      <td>16.0</td>
      <td>225</td>
      <td>MALE</td>
      <td>8.38324</td>
      <td>-26.84272</td>
      <td>793.60</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0bd48f85-1666-4d7b-bf45-01fc4727c64d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0bd48f85-1666-4d7b-bf45-01fc4727c64d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0bd48f85-1666-4d7b-bf45-01fc4727c64d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
train.isna().sum(), test.isna().sum()
```

V3


```python
train = pd.read_csv("/content/drive/MyDrive/daycon/penguin/train.csv")
test = pd.read_csv("/content/drive/MyDrive/daycon/penguin/test.csv")

train = train.drop('id', 1)
Mass = train['Body Mass (g)']
Sex_train = train['Sex']
Sex_test = test['Sex']

train = train.drop('Body Mass (g)', 1)
train = train.drop('Clutch Completion', 1)
test = test.drop('Clutch Completion', 1)
#train['Culmen Width'] = train['Culmen Length (mm)']*train['Culmen Depth (mm)']
#test['Culmen Width'] = test['Culmen Length (mm)']*test['Culmen Depth (mm)']
```


```python
train = train.dropna(axis=0)
test = test.dropna(axis=0)
```


```python
from sklearn.preprocessing import StandardScaler

# Normalization 최소값 0 / 최대값 1
scaler = StandardScaler()

scaled = scaler.fit_transform(train.loc[:,['Culmen Length (mm)', 'Culmen Depth (mm)',
                                           'Flipper Length (mm)', 'Delta 15 N (o/oo)','Delta 13 C (o/oo)']])
```


```python
train['Culmen Length (mm)'] = scaled[:,0]
train['Culmen Depth (mm)'] = scaled[:,1]
#train['Culmen Width'] = scaled[:,2]
train['Flipper Length (mm)'] = scaled[:,2]
train['Delta 15 N (o/oo)'] = scaled[:,3]
train['Delta 13 C (o/oo)'] = scaled[:,4]
```


```python
from sklearn.preprocessing import StandardScaler

# Normalization 최소값 0 / 최대값 1
scaler = StandardScaler()

scaled = scaler.fit_transform(test.loc[:,['Culmen Length (mm)', 'Culmen Depth (mm)',
                                           'Flipper Length (mm)', 'Delta 15 N (o/oo)','Delta 13 C (o/oo)']])
```


```python
test['Culmen Length (mm)'] = scaled[:,0]
test['Culmen Depth (mm)'] = scaled[:,1]
#test['Culmen Width'] = scaled[:,2]
test['Flipper Length (mm)'] = scaled[:,2]
test['Delta 15 N (o/oo)'] = scaled[:,3]
test['Delta 13 C (o/oo)'] = scaled[:,4]
```


```python
train = pd.get_dummies(train)
test = pd.get_dummies(test)
```


```python
train = train.drop(['Sex_FEMALE','Sex_MALE'],axis = 1)
train['Sex']=Sex_train
test = test.drop(['Sex_FEMALE','Sex_MALE'],axis = 1)
test['Sex']=Sex_test

train['Sex']=np.where(train['Sex'].values=='MALE',1,np.where(train['Sex'].values=='FEMALE',0,np.nan))
test['Sex']=np.where(test['Sex'].values=='MALE',1,np.where(test['Sex'].values=='FEMALE',0,np.nan))
```


```python
train.head()
```





  <div id="df-9ae245c8-9ef9-4f76-b443-f492cd54cba8">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Species_Adelie Penguin (Pygoscelis adeliae)</th>
      <th>Species_Chinstrap penguin (Pygoscelis antarctica)</th>
      <th>Species_Gentoo penguin (Pygoscelis papua)</th>
      <th>Island_Biscoe</th>
      <th>Island_Dream</th>
      <th>Island_Torgersen</th>
      <th>Sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.986221</td>
      <td>-0.870742</td>
      <td>1.131607</td>
      <td>-0.764290</td>
      <td>0.618120</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.890718</td>
      <td>1.054533</td>
      <td>-0.240419</td>
      <td>1.573390</td>
      <td>1.604208</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.050292</td>
      <td>-1.339052</td>
      <td>0.445594</td>
      <td>-0.386266</td>
      <td>-1.519754</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.064311</td>
      <td>-1.182948</td>
      <td>0.719999</td>
      <td>-0.947853</td>
      <td>-0.522009</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.909819</td>
      <td>-0.506501</td>
      <td>1.474613</td>
      <td>-0.626578</td>
      <td>-1.314172</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9ae245c8-9ef9-4f76-b443-f492cd54cba8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9ae245c8-9ef9-4f76-b443-f492cd54cba8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9ae245c8-9ef9-4f76-b443-f492cd54cba8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
train.isna().sum(), test.isna().sum()
```




    (Culmen Length (mm)                                   0
     Culmen Depth (mm)                                    0
     Flipper Length (mm)                                  0
     Delta 15 N (o/oo)                                    0
     Delta 13 C (o/oo)                                    0
     Species_Adelie Penguin (Pygoscelis adeliae)          0
     Species_Chinstrap penguin (Pygoscelis antarctica)    0
     Species_Gentoo penguin (Pygoscelis papua)            0
     Island_Biscoe                                        0
     Island_Dream                                         0
     Island_Torgersen                                     0
     Sex                                                  0
     dtype: int64, id                                                   0
     Culmen Length (mm)                                   0
     Culmen Depth (mm)                                    0
     Flipper Length (mm)                                  0
     Delta 15 N (o/oo)                                    0
     Delta 13 C (o/oo)                                    0
     Species_Adelie Penguin (Pygoscelis adeliae)          0
     Species_Chinstrap penguin (Pygoscelis antarctica)    0
     Species_Gentoo penguin (Pygoscelis papua)            0
     Island_Biscoe                                        0
     Island_Dream                                         0
     Island_Torgersen                                     0
     Sex                                                  0
     dtype: int64)



성별 결측치 채우기


```python
setup(train, target = 'Sex',session_id=1234) 
```


```python
top5 = compare_models(sort='RMSE', n_select=5)
```



  <div id="df-30fd7106-751f-4687-a1e9-c74f9fd90c05">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
      <th>TT (Sec)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>et</th>
      <td>Extra Trees Regressor</td>
      <td>0.1805</td>
      <td>0.0813</td>
      <td>0.2540</td>
      <td>0.5906</td>
      <td>0.0</td>
      <td>0.1304</td>
      <td>0.357</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Regressor</td>
      <td>0.2032</td>
      <td>0.1074</td>
      <td>0.2960</td>
      <td>0.4816</td>
      <td>0.0</td>
      <td>0.1745</td>
      <td>0.411</td>
    </tr>
    <tr>
      <th>br</th>
      <td>Bayesian Ridge</td>
      <td>0.2786</td>
      <td>0.1094</td>
      <td>0.3199</td>
      <td>0.4220</td>
      <td>0.0</td>
      <td>0.2446</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>gbr</th>
      <td>Gradient Boosting Regressor</td>
      <td>0.2042</td>
      <td>0.1516</td>
      <td>0.3212</td>
      <td>0.1975</td>
      <td>0.0</td>
      <td>0.1420</td>
      <td>0.048</td>
    </tr>
    <tr>
      <th>ridge</th>
      <td>Ridge Regression</td>
      <td>0.2812</td>
      <td>0.1099</td>
      <td>0.3228</td>
      <td>0.4201</td>
      <td>0.0</td>
      <td>0.2543</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>AdaBoost Regressor</td>
      <td>0.1875</td>
      <td>0.1446</td>
      <td>0.3245</td>
      <td>0.2944</td>
      <td>0.0</td>
      <td>0.1260</td>
      <td>0.072</td>
    </tr>
    <tr>
      <th>lr</th>
      <td>Linear Regression</td>
      <td>0.2852</td>
      <td>0.1180</td>
      <td>0.3317</td>
      <td>0.3785</td>
      <td>0.0</td>
      <td>0.2475</td>
      <td>0.285</td>
    </tr>
    <tr>
      <th>dt</th>
      <td>Decision Tree Regressor</td>
      <td>0.1661</td>
      <td>0.1661</td>
      <td>0.3320</td>
      <td>0.0838</td>
      <td>0.0</td>
      <td>0.1762</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>huber</th>
      <td>Huber Regressor</td>
      <td>0.2914</td>
      <td>0.1224</td>
      <td>0.3384</td>
      <td>0.3494</td>
      <td>0.0</td>
      <td>0.2508</td>
      <td>0.035</td>
    </tr>
    <tr>
      <th>par</th>
      <td>Passive Aggressive Regressor</td>
      <td>0.3026</td>
      <td>0.1477</td>
      <td>0.3716</td>
      <td>0.2446</td>
      <td>0.0</td>
      <td>0.3076</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>omp</th>
      <td>Orthogonal Matching Pursuit</td>
      <td>0.3643</td>
      <td>0.1761</td>
      <td>0.4096</td>
      <td>0.1231</td>
      <td>0.0</td>
      <td>0.3828</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>lasso</th>
      <td>Lasso Regression</td>
      <td>0.5079</td>
      <td>0.2584</td>
      <td>0.5082</td>
      <td>-0.2909</td>
      <td>0.0</td>
      <td>0.4937</td>
      <td>0.014</td>
    </tr>
    <tr>
      <th>en</th>
      <td>Elastic Net</td>
      <td>0.5079</td>
      <td>0.2584</td>
      <td>0.5082</td>
      <td>-0.2909</td>
      <td>0.0</td>
      <td>0.4937</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>llar</th>
      <td>Lasso Least Angle Regression</td>
      <td>0.5079</td>
      <td>0.2584</td>
      <td>0.5082</td>
      <td>-0.2909</td>
      <td>0.0</td>
      <td>0.4937</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>dummy</th>
      <td>Dummy Regressor</td>
      <td>0.5079</td>
      <td>0.2584</td>
      <td>0.5082</td>
      <td>-0.2909</td>
      <td>0.0</td>
      <td>0.4937</td>
      <td>0.010</td>
    </tr>
    <tr>
      <th>lar</th>
      <td>Least Angle Regression</td>
      <td>0.7688</td>
      <td>2.7615</td>
      <td>0.8922</td>
      <td>-10.2824</td>
      <td>0.0</td>
      <td>0.6511</td>
      <td>0.016</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-30fd7106-751f-4687-a1e9-c74f9fd90c05')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-30fd7106-751f-4687-a1e9-c74f9fd90c05 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-30fd7106-751f-4687-a1e9-c74f9fd90c05');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
tuned_top5 = [tune_model(i) for i in top5]
```



  <div id="df-b723d79b-8259-499d-809b-ab07ee4df396">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.2793</td>
      <td>0.1136</td>
      <td>0.3371</td>
      <td>0.5455</td>
      <td>-0.0</td>
      <td>0.3658</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.2288</td>
      <td>0.0680</td>
      <td>0.2608</td>
      <td>0.7279</td>
      <td>-0.0</td>
      <td>0.1398</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.4167</td>
      <td>0.1986</td>
      <td>0.4457</td>
      <td>0.1525</td>
      <td>-0.0</td>
      <td>0.3797</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3154</td>
      <td>0.1260</td>
      <td>0.3550</td>
      <td>0.4960</td>
      <td>-0.0</td>
      <td>0.3209</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.3102</td>
      <td>0.1106</td>
      <td>0.3326</td>
      <td>0.4101</td>
      <td>-0.0</td>
      <td>0.2190</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.4077</td>
      <td>0.1879</td>
      <td>0.4334</td>
      <td>0.1985</td>
      <td>-0.0</td>
      <td>0.4082</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.3176</td>
      <td>0.1238</td>
      <td>0.3519</td>
      <td>0.3397</td>
      <td>-0.0</td>
      <td>0.3180</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.2114</td>
      <td>0.0684</td>
      <td>0.2616</td>
      <td>0.7080</td>
      <td>-0.0</td>
      <td>0.1527</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.3982</td>
      <td>0.1754</td>
      <td>0.4188</td>
      <td>-0.6033</td>
      <td>-0.0</td>
      <td>0.3900</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.3484</td>
      <td>0.1412</td>
      <td>0.3758</td>
      <td>0.3080</td>
      <td>-0.0</td>
      <td>0.2380</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.3234</td>
      <td>0.1314</td>
      <td>0.3573</td>
      <td>0.3283</td>
      <td>0.0</td>
      <td>0.2932</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>0.0676</td>
      <td>0.0431</td>
      <td>0.0610</td>
      <td>0.3609</td>
      <td>0.0</td>
      <td>0.0941</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b723d79b-8259-499d-809b-ab07ee4df396')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b723d79b-8259-499d-809b-ab07ee4df396 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b723d79b-8259-499d-809b-ab07ee4df396');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
blender_top5 = blend_models(estimator_list=tuned_top5)
sex_model = finalize_model(blender_top5)
```



  <div id="df-906a16a0-6151-4650-b4ec-90a4200b6858">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.2306</td>
      <td>0.0807</td>
      <td>0.2841</td>
      <td>0.6771</td>
      <td>-0.0</td>
      <td>0.2977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1840</td>
      <td>0.0483</td>
      <td>0.2198</td>
      <td>0.8068</td>
      <td>-0.0</td>
      <td>0.1059</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.4029</td>
      <td>0.2060</td>
      <td>0.4538</td>
      <td>0.1213</td>
      <td>-0.0</td>
      <td>0.3503</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.2492</td>
      <td>0.1020</td>
      <td>0.3194</td>
      <td>0.5919</td>
      <td>-0.0</td>
      <td>0.2889</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.2433</td>
      <td>0.0791</td>
      <td>0.2813</td>
      <td>0.5779</td>
      <td>-0.0</td>
      <td>0.1712</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.3228</td>
      <td>0.1274</td>
      <td>0.3569</td>
      <td>0.4566</td>
      <td>-0.0</td>
      <td>0.3187</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.2108</td>
      <td>0.0549</td>
      <td>0.2343</td>
      <td>0.7072</td>
      <td>-0.0</td>
      <td>0.2164</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.1520</td>
      <td>0.0332</td>
      <td>0.1823</td>
      <td>0.8582</td>
      <td>-0.0</td>
      <td>0.1381</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.3584</td>
      <td>0.1495</td>
      <td>0.3867</td>
      <td>-0.3671</td>
      <td>-0.0</td>
      <td>0.3622</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.3162</td>
      <td>0.1318</td>
      <td>0.3630</td>
      <td>0.3544</td>
      <td>-0.0</td>
      <td>0.1695</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.2670</td>
      <td>0.1013</td>
      <td>0.3082</td>
      <td>0.4784</td>
      <td>0.0</td>
      <td>0.2419</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>0.0760</td>
      <td>0.0504</td>
      <td>0.0796</td>
      <td>0.3500</td>
      <td>0.0</td>
      <td>0.0881</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-906a16a0-6151-4650-b4ec-90a4200b6858')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-906a16a0-6151-4650-b4ec-90a4200b6858 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-906a16a0-6151-4650-b4ec-90a4200b6858');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
train.columns
```




    Index(['Culmen Length (mm)', 'Culmen Depth (mm)', 'Flipper Length (mm)',
           'Delta 15 N (o/oo)', 'Delta 13 C (o/oo)', 'Culmen Width',
           'Species_Adelie Penguin (Pygoscelis adeliae)',
           'Species_Chinstrap penguin (Pygoscelis antarctica)',
           'Species_Gentoo penguin (Pygoscelis papua)', 'Island_Biscoe',
           'Island_Dream', 'Island_Torgersen', 'Sex'],
          dtype='object')




```python
sex_features = ['Culmen Length (mm)', 'Culmen Depth (mm)', 'Flipper Length (mm)',
       'Delta 15 N (o/oo)', 'Delta 13 C (o/oo)', 'Culmen Width',
       'Species_Adelie Penguin (Pygoscelis adeliae)',
       'Species_Chinstrap penguin (Pygoscelis antarctica)',
       'Species_Gentoo penguin (Pygoscelis papua)', 'Island_Biscoe',
       'Island_Dream', 'Island_Torgersen', 'Sex']
```


```python
pred_sex_train = predict_model(sex_model, data = train[train['Sex'].isnull()][sex_features])
```


```python
train['Sex'].iloc[np.where(train['Sex'].isnull()==True)] = pred_sex_train['Label']
```


```python
pred_sex_test = predict_model(sex_model, data = test[test['Sex'].isnull()][sex_features])
```


```python
test['Sex'].iloc[np.where(train['Sex'].isnull()==True)] = pred_sex_test['Label']
```


```python
train['Sex'].iloc[np.where(train['Sex'].isnull()==True)]
```




    Series([], Name: Sex, dtype: float64)




```python
test['Sex'].iloc[np.where(train['Sex'].isnull()==True)]
```




    Series([], Name: Sex, dtype: float64)



다른 결측치에도 동일 과정 반복

Delta 15 N (o/oo)


```python
setup(train, target = 'Delta 15 N (o/oo)', session_id = 1234) 
```


```python
top5 = compare_models(sort='RMSE', n_select=5)
```


```python
tuned_top5 = [tune_model(i) for i in top5]
```



  <div id="df-b2a09537-fcfc-49aa-bfaf-bd8dc1c9fb5f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1290</td>
      <td>0.0280</td>
      <td>0.1674</td>
      <td>0.4434</td>
      <td>0.1181</td>
      <td>0.4271</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1371</td>
      <td>0.0311</td>
      <td>0.1762</td>
      <td>0.6618</td>
      <td>0.1231</td>
      <td>0.1831</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.1256</td>
      <td>0.0302</td>
      <td>0.1739</td>
      <td>-0.2935</td>
      <td>0.1257</td>
      <td>0.4812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1623</td>
      <td>0.0381</td>
      <td>0.1953</td>
      <td>0.5744</td>
      <td>0.1399</td>
      <td>0.8971</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.1782</td>
      <td>0.0439</td>
      <td>0.2096</td>
      <td>0.4863</td>
      <td>0.1464</td>
      <td>38.0130</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0782</td>
      <td>0.0085</td>
      <td>0.0921</td>
      <td>0.5437</td>
      <td>0.0697</td>
      <td>0.2502</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0928</td>
      <td>0.0118</td>
      <td>0.1088</td>
      <td>0.3784</td>
      <td>0.0764</td>
      <td>0.3008</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.1176</td>
      <td>0.0212</td>
      <td>0.1457</td>
      <td>0.1049</td>
      <td>0.1035</td>
      <td>0.3916</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.0417</td>
      <td>0.0032</td>
      <td>0.0567</td>
      <td>0.8832</td>
      <td>0.0419</td>
      <td>0.1241</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.1342</td>
      <td>0.0252</td>
      <td>0.1586</td>
      <td>0.4452</td>
      <td>0.1174</td>
      <td>0.6297</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.1197</td>
      <td>0.0241</td>
      <td>0.1484</td>
      <td>0.4228</td>
      <td>0.1062</td>
      <td>4.1698</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>0.0379</td>
      <td>0.0124</td>
      <td>0.0458</td>
      <td>0.3046</td>
      <td>0.0317</td>
      <td>11.2831</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b2a09537-fcfc-49aa-bfaf-bd8dc1c9fb5f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b2a09537-fcfc-49aa-bfaf-bd8dc1c9fb5f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b2a09537-fcfc-49aa-bfaf-bd8dc1c9fb5f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
blender_top5 = blend_models(estimator_list=tuned_top5)
D15N_model = finalize_model(blender_top5)
```



  <div id="df-70151434-4000-488b-a8c7-fb644adf2a80">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1160</td>
      <td>0.0220</td>
      <td>0.1483</td>
      <td>0.5630</td>
      <td>0.1043</td>
      <td>0.3697</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1412</td>
      <td>0.0321</td>
      <td>0.1792</td>
      <td>0.6502</td>
      <td>0.1222</td>
      <td>0.1856</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.1304</td>
      <td>0.0332</td>
      <td>0.1822</td>
      <td>-0.4197</td>
      <td>0.1299</td>
      <td>0.4938</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1588</td>
      <td>0.0354</td>
      <td>0.1882</td>
      <td>0.6047</td>
      <td>0.1326</td>
      <td>0.8318</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.1630</td>
      <td>0.0386</td>
      <td>0.1964</td>
      <td>0.5492</td>
      <td>0.1346</td>
      <td>32.8805</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0592</td>
      <td>0.0049</td>
      <td>0.0699</td>
      <td>0.7367</td>
      <td>0.0512</td>
      <td>0.1799</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0964</td>
      <td>0.0117</td>
      <td>0.1082</td>
      <td>0.3852</td>
      <td>0.0771</td>
      <td>0.3067</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.1158</td>
      <td>0.0201</td>
      <td>0.1418</td>
      <td>0.1520</td>
      <td>0.1013</td>
      <td>0.3929</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.0389</td>
      <td>0.0028</td>
      <td>0.0526</td>
      <td>0.8997</td>
      <td>0.0395</td>
      <td>0.1255</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.1365</td>
      <td>0.0256</td>
      <td>0.1601</td>
      <td>0.4346</td>
      <td>0.1173</td>
      <td>0.6290</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.1156</td>
      <td>0.0226</td>
      <td>0.1427</td>
      <td>0.4556</td>
      <td>0.1010</td>
      <td>3.6395</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>0.0385</td>
      <td>0.0121</td>
      <td>0.0477</td>
      <td>0.3493</td>
      <td>0.0324</td>
      <td>9.7492</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-70151434-4000-488b-a8c7-fb644adf2a80')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-70151434-4000-488b-a8c7-fb644adf2a80 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-70151434-4000-488b-a8c7-fb644adf2a80');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
train.columns
```




    Index(['Culmen Length (mm)', 'Culmen Depth (mm)', 'Flipper Length (mm)', 'Sex',
           'Delta 15 N (o/oo)', 'Delta 13 C (o/oo)', 'Island_Biscoe',
           'Island_Dream', 'Island_Torgersen',
           'Species_Adelie Penguin (Pygoscelis adeliae)',
           'Species_Chinstrap penguin (Pygoscelis antarctica)',
           'Species_Gentoo penguin (Pygoscelis papua)', 'Culmen Width'],
          dtype='object')




```python
D15N_features = ['Culmen Length (mm)', 'Culmen Depth (mm)', 'Flipper Length (mm)',
       'Delta 15 N (o/oo)', 'Delta 13 C (o/oo)', 'Culmen Width',
       'Species_Adelie Penguin (Pygoscelis adeliae)',
       'Species_Chinstrap penguin (Pygoscelis antarctica)',
       'Species_Gentoo penguin (Pygoscelis papua)', 'Island_Biscoe',
       'Island_Dream', 'Island_Torgersen', 'Sex']
```


```python
pred_D15N_train = predict_model(D15N_model, data = train[train['Delta 15 N (o/oo)'].isnull()][D15N_features])
train['Delta 15 N (o/oo)'].iloc[np.where(train['Delta 15 N (o/oo)'].isnull()==True)] = pred_D15N_train['Label']
```


```python
pred_D15N_test = predict_model(D15N_model, data = test[test['Delta 15 N (o/oo)'].isnull()][D15N_features])
test['Delta 15 N (o/oo)'].iloc[np.where(test['Delta 15 N (o/oo)'].isnull()==True)] = pred_D15N_test['Label']
```

Delta 13 C (o/oo)


```python
setup(train, target = 'Delta 13 C (o/oo)', session_id = 1234) 
```


```python
top5 = compare_models(sort='RMSE', n_select=5)
```


```python
tuned_top5 = [tune_model(i) for i in top5]
```



  <div id="df-4bc3f36d-8f10-4997-a46e-a00a9c11a84e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.2096</td>
      <td>0.0650</td>
      <td>0.2550</td>
      <td>0.5309</td>
      <td>0.1813</td>
      <td>1.4158</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0785</td>
      <td>0.0104</td>
      <td>0.1018</td>
      <td>0.8693</td>
      <td>0.0733</td>
      <td>0.2676</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.1465</td>
      <td>0.0305</td>
      <td>0.1745</td>
      <td>0.5919</td>
      <td>0.1302</td>
      <td>0.9835</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1321</td>
      <td>0.0385</td>
      <td>0.1962</td>
      <td>0.4216</td>
      <td>0.1257</td>
      <td>0.2674</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.1660</td>
      <td>0.0457</td>
      <td>0.2137</td>
      <td>0.0960</td>
      <td>0.1503</td>
      <td>0.5013</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.2254</td>
      <td>0.0602</td>
      <td>0.2455</td>
      <td>-0.8196</td>
      <td>0.1951</td>
      <td>2.9124</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.2095</td>
      <td>0.0656</td>
      <td>0.2562</td>
      <td>0.0682</td>
      <td>0.1775</td>
      <td>0.5062</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.1036</td>
      <td>0.0137</td>
      <td>0.1169</td>
      <td>0.4323</td>
      <td>0.0926</td>
      <td>0.6184</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.1638</td>
      <td>0.0383</td>
      <td>0.1958</td>
      <td>0.4750</td>
      <td>0.1449</td>
      <td>1.1052</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.1560</td>
      <td>0.0359</td>
      <td>0.1894</td>
      <td>0.6704</td>
      <td>0.1281</td>
      <td>0.5824</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.1591</td>
      <td>0.0404</td>
      <td>0.1945</td>
      <td>0.3336</td>
      <td>0.1399</td>
      <td>0.9160</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>0.0448</td>
      <td>0.0185</td>
      <td>0.0505</td>
      <td>0.4472</td>
      <td>0.0366</td>
      <td>0.7521</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4bc3f36d-8f10-4997-a46e-a00a9c11a84e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4bc3f36d-8f10-4997-a46e-a00a9c11a84e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4bc3f36d-8f10-4997-a46e-a00a9c11a84e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
blender_top5 = blend_models(estimator_list=tuned_top5)
D13C_model = finalize_model(blender_top5)
```



  <div id="df-1175b15a-2f57-4595-b608-413423bb5cc0">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1732</td>
      <td>0.0535</td>
      <td>0.2313</td>
      <td>0.6140</td>
      <td>0.1575</td>
      <td>1.0795</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0768</td>
      <td>0.0113</td>
      <td>0.1062</td>
      <td>0.8578</td>
      <td>0.0749</td>
      <td>0.2160</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.1276</td>
      <td>0.0232</td>
      <td>0.1523</td>
      <td>0.6895</td>
      <td>0.1125</td>
      <td>0.9242</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1619</td>
      <td>0.0546</td>
      <td>0.2336</td>
      <td>0.1802</td>
      <td>0.1510</td>
      <td>0.3213</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.1472</td>
      <td>0.0360</td>
      <td>0.1896</td>
      <td>0.2885</td>
      <td>0.1372</td>
      <td>0.4136</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.1907</td>
      <td>0.0453</td>
      <td>0.2128</td>
      <td>-0.3677</td>
      <td>0.1746</td>
      <td>2.7584</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.2052</td>
      <td>0.0683</td>
      <td>0.2614</td>
      <td>0.0299</td>
      <td>0.1829</td>
      <td>0.4897</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.1067</td>
      <td>0.0155</td>
      <td>0.1246</td>
      <td>0.3552</td>
      <td>0.0947</td>
      <td>0.5799</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.1358</td>
      <td>0.0264</td>
      <td>0.1626</td>
      <td>0.6378</td>
      <td>0.1247</td>
      <td>1.0294</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.1155</td>
      <td>0.0169</td>
      <td>0.1301</td>
      <td>0.8445</td>
      <td>0.0924</td>
      <td>0.4877</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.1441</td>
      <td>0.0351</td>
      <td>0.1805</td>
      <td>0.4130</td>
      <td>0.1302</td>
      <td>0.8300</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>0.0376</td>
      <td>0.0185</td>
      <td>0.0504</td>
      <td>0.3716</td>
      <td>0.0347</td>
      <td>0.7024</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1175b15a-2f57-4595-b608-413423bb5cc0')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1175b15a-2f57-4595-b608-413423bb5cc0 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1175b15a-2f57-4595-b608-413423bb5cc0');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
D13C_features = ['Culmen Length (mm)', 'Culmen Depth (mm)', 'Flipper Length (mm)',
       'Delta 15 N (o/oo)', 'Delta 13 C (o/oo)', 'Culmen Width',
       'Species_Adelie Penguin (Pygoscelis adeliae)',
       'Species_Chinstrap penguin (Pygoscelis antarctica)',
       'Species_Gentoo penguin (Pygoscelis papua)', 'Island_Biscoe',
       'Island_Dream', 'Island_Torgersen', 'Sex']
```


```python
pred_D13C_train = predict_model(D13C_model, data = train[train['Delta 13 C (o/oo)'].isnull()][D13C_features])
train['Delta 13 C (o/oo)'].iloc[np.where(train['Delta 13 C (o/oo)'].isnull()==True)] = pred_D13C_train['Label']
```


```python
pred_D13C_test= predict_model(D13C_model, data = test[test['Delta 13 C (o/oo)'].isnull()][D13C_features])
test['Delta 13 C (o/oo)'].iloc[np.where(test['Delta 13 C (o/oo)'].isnull()==True)] = pred_D13C_test['Label']
```


```python
missing_col = check_missing_col(train)
```

    결측치가 존재하지 않습니다
    


```python
train['Body Mass (g)'] = Mass
```


```python
train.head()
```





  <div id="df-d7bb9d3d-e827-4cd6-828e-72d044809a94">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Sex</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Island_Biscoe</th>
      <th>Island_Dream</th>
      <th>Island_Torgersen</th>
      <th>Species_Adelie Penguin (Pygoscelis adeliae)</th>
      <th>Species_Chinstrap penguin (Pygoscelis antarctica)</th>
      <th>Species_Gentoo penguin (Pygoscelis papua)</th>
      <th>Culmen Width</th>
      <th>Body Mass (g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>15.3</td>
      <td>220</td>
      <td>1.0</td>
      <td>8.30515</td>
      <td>-25.19017</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>765.00</td>
      <td>5550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>49.5</td>
      <td>19.0</td>
      <td>200</td>
      <td>1.0</td>
      <td>9.63074</td>
      <td>-24.34684</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>940.50</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>45.1</td>
      <td>14.4</td>
      <td>210</td>
      <td>0.0</td>
      <td>8.51951</td>
      <td>-27.01854</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>649.44</td>
      <td>4400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>44.5</td>
      <td>14.7</td>
      <td>214</td>
      <td>0.0</td>
      <td>8.20106</td>
      <td>-26.16524</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>654.15</td>
      <td>4850</td>
    </tr>
    <tr>
      <th>4</th>
      <td>49.6</td>
      <td>16.0</td>
      <td>225</td>
      <td>1.0</td>
      <td>8.38324</td>
      <td>-26.84272</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>793.60</td>
      <td>5700</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d7bb9d3d-e827-4cd6-828e-72d044809a94')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d7bb9d3d-e827-4cd6-828e-72d044809a94 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d7bb9d3d-e827-4cd6-828e-72d044809a94');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
setup(train, target = 'Body Mass (g)', session_id = 1234)
```


```python
top5 = compare_models(sort='RMSE', n_select=3) 
```



  <div id="df-4ca1c701-1d66-464e-a207-eb95cd3aaa2c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
      <th>TT (Sec)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>par</th>
      <td>Passive Aggressive Regressor</td>
      <td>238.0480</td>
      <td>97565.8661</td>
      <td>292.8484</td>
      <td>0.6617</td>
      <td>0.0687</td>
      <td>0.0570</td>
      <td>0.014</td>
    </tr>
    <tr>
      <th>et</th>
      <td>Extra Trees Regressor</td>
      <td>239.2335</td>
      <td>92955.2414</td>
      <td>294.5528</td>
      <td>0.7391</td>
      <td>0.0677</td>
      <td>0.0554</td>
      <td>0.375</td>
    </tr>
    <tr>
      <th>llar</th>
      <td>Lasso Least Angle Regression</td>
      <td>242.4653</td>
      <td>96572.3446</td>
      <td>294.9615</td>
      <td>0.6872</td>
      <td>0.0689</td>
      <td>0.0575</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>ridge</th>
      <td>Ridge Regression</td>
      <td>249.8875</td>
      <td>103341.0724</td>
      <td>304.2553</td>
      <td>0.6752</td>
      <td>0.0713</td>
      <td>0.0590</td>
      <td>0.014</td>
    </tr>
    <tr>
      <th>br</th>
      <td>Bayesian Ridge</td>
      <td>248.6495</td>
      <td>103395.3157</td>
      <td>305.0092</td>
      <td>0.6748</td>
      <td>0.0714</td>
      <td>0.0586</td>
      <td>0.014</td>
    </tr>
    <tr>
      <th>lasso</th>
      <td>Lasso Regression</td>
      <td>253.5874</td>
      <td>104931.9545</td>
      <td>305.8343</td>
      <td>0.6698</td>
      <td>0.0718</td>
      <td>0.0602</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>huber</th>
      <td>Huber Regressor</td>
      <td>250.6762</td>
      <td>106013.4123</td>
      <td>309.0548</td>
      <td>0.6623</td>
      <td>0.0722</td>
      <td>0.0593</td>
      <td>0.030</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Regressor</td>
      <td>257.7893</td>
      <td>103940.1719</td>
      <td>309.3241</td>
      <td>0.6846</td>
      <td>0.0716</td>
      <td>0.0602</td>
      <td>0.413</td>
    </tr>
    <tr>
      <th>lr</th>
      <td>Linear Regression</td>
      <td>256.1956</td>
      <td>107683.6206</td>
      <td>309.3566</td>
      <td>0.6626</td>
      <td>0.0728</td>
      <td>0.0608</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>gbr</th>
      <td>Gradient Boosting Regressor</td>
      <td>277.1432</td>
      <td>115205.9830</td>
      <td>324.7622</td>
      <td>0.6773</td>
      <td>0.0754</td>
      <td>0.0642</td>
      <td>0.046</td>
    </tr>
    <tr>
      <th>lightgbm</th>
      <td>Light Gradient Boosting Machine</td>
      <td>278.8731</td>
      <td>117811.7040</td>
      <td>332.7139</td>
      <td>0.6378</td>
      <td>0.0777</td>
      <td>0.0659</td>
      <td>0.023</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>AdaBoost Regressor</td>
      <td>292.5921</td>
      <td>128391.4335</td>
      <td>342.1885</td>
      <td>0.6374</td>
      <td>0.0797</td>
      <td>0.0688</td>
      <td>0.074</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>K Neighbors Regressor</td>
      <td>286.5089</td>
      <td>125677.8125</td>
      <td>342.2131</td>
      <td>0.6025</td>
      <td>0.0804</td>
      <td>0.0679</td>
      <td>0.064</td>
    </tr>
    <tr>
      <th>lar</th>
      <td>Least Angle Regression</td>
      <td>288.1774</td>
      <td>129362.0551</td>
      <td>345.8219</td>
      <td>0.6079</td>
      <td>0.0808</td>
      <td>0.0679</td>
      <td>0.016</td>
    </tr>
    <tr>
      <th>en</th>
      <td>Elastic Net</td>
      <td>295.7185</td>
      <td>132404.1458</td>
      <td>356.2951</td>
      <td>0.6035</td>
      <td>0.0834</td>
      <td>0.0702</td>
      <td>0.018</td>
    </tr>
    <tr>
      <th>omp</th>
      <td>Orthogonal Matching Pursuit</td>
      <td>303.4402</td>
      <td>137777.0487</td>
      <td>358.5425</td>
      <td>0.6217</td>
      <td>0.0850</td>
      <td>0.0717</td>
      <td>0.014</td>
    </tr>
    <tr>
      <th>dt</th>
      <td>Decision Tree Regressor</td>
      <td>340.6696</td>
      <td>173992.1875</td>
      <td>408.6695</td>
      <td>0.5673</td>
      <td>0.0920</td>
      <td>0.0771</td>
      <td>0.016</td>
    </tr>
    <tr>
      <th>dummy</th>
      <td>Dummy Regressor</td>
      <td>672.0343</td>
      <td>614582.4242</td>
      <td>774.4817</td>
      <td>-0.7219</td>
      <td>0.1770</td>
      <td>0.1582</td>
      <td>0.011</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4ca1c701-1d66-464e-a207-eb95cd3aaa2c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4ca1c701-1d66-464e-a207-eb95cd3aaa2c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4ca1c701-1d66-464e-a207-eb95cd3aaa2c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
tuned_top5 = [tune_model(i) for i in top5]
```



  <div id="df-42abd139-c7cb-4bb9-8edb-b39bc35af2c3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>221.4795</td>
      <td>60269.2728</td>
      <td>245.4980</td>
      <td>0.8996</td>
      <td>0.0539</td>
      <td>0.0477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>211.0657</td>
      <td>86767.8098</td>
      <td>294.5638</td>
      <td>0.7753</td>
      <td>0.0677</td>
      <td>0.0458</td>
    </tr>
    <tr>
      <th>2</th>
      <td>272.2325</td>
      <td>106181.5977</td>
      <td>325.8552</td>
      <td>0.6781</td>
      <td>0.0714</td>
      <td>0.0617</td>
    </tr>
    <tr>
      <th>3</th>
      <td>355.2899</td>
      <td>163203.4167</td>
      <td>403.9844</td>
      <td>0.7719</td>
      <td>0.0910</td>
      <td>0.0806</td>
    </tr>
    <tr>
      <th>4</th>
      <td>245.9112</td>
      <td>106294.8659</td>
      <td>326.0289</td>
      <td>0.7355</td>
      <td>0.0798</td>
      <td>0.0615</td>
    </tr>
    <tr>
      <th>5</th>
      <td>126.2978</td>
      <td>27887.8685</td>
      <td>166.9966</td>
      <td>0.9347</td>
      <td>0.0372</td>
      <td>0.0294</td>
    </tr>
    <tr>
      <th>6</th>
      <td>99.0947</td>
      <td>20266.7777</td>
      <td>142.3614</td>
      <td>0.9438</td>
      <td>0.0258</td>
      <td>0.0184</td>
    </tr>
    <tr>
      <th>7</th>
      <td>182.4158</td>
      <td>47238.7609</td>
      <td>217.3448</td>
      <td>0.9298</td>
      <td>0.0493</td>
      <td>0.0395</td>
    </tr>
    <tr>
      <th>8</th>
      <td>310.7358</td>
      <td>129797.8889</td>
      <td>360.2747</td>
      <td>0.7201</td>
      <td>0.0859</td>
      <td>0.0736</td>
    </tr>
    <tr>
      <th>9</th>
      <td>400.1304</td>
      <td>217815.1869</td>
      <td>466.7067</td>
      <td>-0.5163</td>
      <td>0.1266</td>
      <td>0.1163</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>242.4653</td>
      <td>96572.3446</td>
      <td>294.9615</td>
      <td>0.6872</td>
      <td>0.0689</td>
      <td>0.0575</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>90.6801</td>
      <td>59007.0078</td>
      <td>97.8268</td>
      <td>0.4121</td>
      <td>0.0278</td>
      <td>0.0268</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-42abd139-c7cb-4bb9-8edb-b39bc35af2c3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-42abd139-c7cb-4bb9-8edb-b39bc35af2c3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-42abd139-c7cb-4bb9-8edb-b39bc35af2c3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
blender_top5 = blend_models(estimator_list=tuned_top5)
```



  <div id="df-a36dfd61-eb49-45f4-8109-9166f65aed49">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R2</th>
      <th>RMSLE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>202.2603</td>
      <td>51063.7229</td>
      <td>225.9728</td>
      <td>0.9149</td>
      <td>0.0482</td>
      <td>0.0428</td>
    </tr>
    <tr>
      <th>1</th>
      <td>219.3657</td>
      <td>80738.4123</td>
      <td>284.1451</td>
      <td>0.7909</td>
      <td>0.0647</td>
      <td>0.0481</td>
    </tr>
    <tr>
      <th>2</th>
      <td>232.9082</td>
      <td>94515.6031</td>
      <td>307.4339</td>
      <td>0.7134</td>
      <td>0.0663</td>
      <td>0.0518</td>
    </tr>
    <tr>
      <th>3</th>
      <td>363.5290</td>
      <td>177193.3652</td>
      <td>420.9434</td>
      <td>0.7524</td>
      <td>0.0961</td>
      <td>0.0817</td>
    </tr>
    <tr>
      <th>4</th>
      <td>251.7031</td>
      <td>110522.0375</td>
      <td>332.4485</td>
      <td>0.7250</td>
      <td>0.0813</td>
      <td>0.0633</td>
    </tr>
    <tr>
      <th>5</th>
      <td>148.6227</td>
      <td>34408.0103</td>
      <td>185.4940</td>
      <td>0.9194</td>
      <td>0.0424</td>
      <td>0.0352</td>
    </tr>
    <tr>
      <th>6</th>
      <td>116.9810</td>
      <td>23761.9064</td>
      <td>154.1490</td>
      <td>0.9341</td>
      <td>0.0282</td>
      <td>0.0222</td>
    </tr>
    <tr>
      <th>7</th>
      <td>177.6882</td>
      <td>44011.2240</td>
      <td>209.7885</td>
      <td>0.9346</td>
      <td>0.0444</td>
      <td>0.0370</td>
    </tr>
    <tr>
      <th>8</th>
      <td>262.6158</td>
      <td>108212.2932</td>
      <td>328.9564</td>
      <td>0.7666</td>
      <td>0.0785</td>
      <td>0.0623</td>
    </tr>
    <tr>
      <th>9</th>
      <td>366.5766</td>
      <td>211846.8630</td>
      <td>460.2683</td>
      <td>-0.4748</td>
      <td>0.1252</td>
      <td>0.1079</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>234.2251</td>
      <td>93627.3438</td>
      <td>290.9600</td>
      <td>0.6977</td>
      <td>0.0675</td>
      <td>0.0552</td>
    </tr>
    <tr>
      <th>SD</th>
      <td>78.0145</td>
      <td>58554.0175</td>
      <td>94.7081</td>
      <td>0.4001</td>
      <td>0.0275</td>
      <td>0.0237</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a36dfd61-eb49-45f4-8109-9166f65aed49')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a36dfd61-eb49-45f4-8109-9166f65aed49 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a36dfd61-eb49-45f4-8109-9166f65aed49');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
final_model = finalize_model(blender_top5)
prediction = predict_model(final_model, data=train)
```


```python
submission = pd.read_csv('/content/drive/MyDrive/daycon/penguin/sample_submission.csv', index_col = 0)
submission.head()
```





  <div id="df-2c723fb0-20b9-4501-99ee-75fdcbacbca3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Body Mass (g)</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-2c723fb0-20b9-4501-99ee-75fdcbacbca3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-2c723fb0-20b9-4501-99ee-75fdcbacbca3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-2c723fb0-20b9-4501-99ee-75fdcbacbca3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
pred = predict_model(final_model, data = test)
pred.head()
```





  <div id="df-6e12914c-3678-461a-b6d3-f2a5cd779430">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Culmen Length (mm)</th>
      <th>Culmen Depth (mm)</th>
      <th>Flipper Length (mm)</th>
      <th>Delta 15 N (o/oo)</th>
      <th>Delta 13 C (o/oo)</th>
      <th>Species_Adelie Penguin (Pygoscelis adeliae)</th>
      <th>Species_Chinstrap penguin (Pygoscelis antarctica)</th>
      <th>Species_Gentoo penguin (Pygoscelis papua)</th>
      <th>Island_Biscoe</th>
      <th>Island_Dream</th>
      <th>Island_Torgersen</th>
      <th>Sex</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1.504388</td>
      <td>1.763971</td>
      <td>0.739161</td>
      <td>1.272167</td>
      <td>1.312191</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>4317.223550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2.207564</td>
      <td>-0.103777</td>
      <td>2.077120</td>
      <td>-0.789764</td>
      <td>-0.903286</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>5622.421239</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-0.857565</td>
      <td>0.804857</td>
      <td>-0.747459</td>
      <td>-0.683764</td>
      <td>-0.581867</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>3552.118631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.278336</td>
      <td>-0.305696</td>
      <td>-0.673128</td>
      <td>1.625950</td>
      <td>1.172299</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>3467.970839</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>-1.037867</td>
      <td>0.703898</td>
      <td>-2.085417</td>
      <td>-0.656730</td>
      <td>0.630281</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3485.924055</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6e12914c-3678-461a-b6d3-f2a5cd779430')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6e12914c-3678-461a-b6d3-f2a5cd779430 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6e12914c-3678-461a-b6d3-f2a5cd779430');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
submission['Body Mass (g)'] = pred['Label']
submission.head()
```





  <div id="df-c5b9118b-53cd-4c28-aec3-3bb5ff87e496">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Body Mass (g)</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4317.223550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5622.421239</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3552.118631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3467.970839</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3485.924055</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c5b9118b-53cd-4c28-aec3-3bb5ff87e496')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c5b9118b-53cd-4c28-aec3-3bb5ff87e496 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c5b9118b-53cd-4c28-aec3-3bb5ff87e496');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
submission.to_csv('pycaret_final.csv')
```
